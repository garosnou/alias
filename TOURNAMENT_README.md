# Турнирная система для игры Alias

## Обзор

Турнирная система позволяет организовать соревнования между командами в игре Alias. Система поддерживает до 8 команд и автоматически создает турнирную сетку.

## Основные компоненты

### Состояние турнира (`tournamentState`)

```javascript
let tournamentState = {
    isTournamentMode: false,        // Флаг турнирного режима
    teams: [],                      // Массив команд
    matches: [],                    // Турнирная сетка
    currentRound: 0,                // Текущий раунд
    currentMatch: 0,                // Текущий матч
    currentTeamIndex: 0,            // Индекс текущей команды (0 или 1)
    currentPlayerIndex: 0,          // Индекс текущего игрока в команде
    matchScores: [],                // Счет текущего матча [команда1, команда2]
    tournamentScores: [],            // Общий счет турнира
    maxRounds: 0,                   // Максимальное количество раундов
    gameMode: 'sequential',         // Режим игры: 'sequential' | 'alternate'
    currentMatchPlayerResults: []    // Результаты игроков текущего матча
};
```

## Режимы игры

### 1. Последовательный режим (`sequential`)
- Сначала играют все игроки первой команды
- Затем все игроки второй команды
- Подходит для команд с разным количеством игроков

### 2. Чередующийся режим (`alternate`)
- Игроки команд играют через одного
- Количество раундов ограничено минимумом игроков в командах
- Более динамичный режим

## Структура команды

```javascript
{
    name: "Название команды",
    players: ["Игрок1", "Игрок2", "Игрок3"],
    score: 0
}
```

## Основные функции

### Управление командами

- `addTeam(name, players)` - Добавление команды
- `removeTeam(index)` - Удаление команды
- `updateTeamsList()` - Обновление списка команд в UI

### Турнирная сетка

- `generateTournamentBracket()` - Создание турнирной сетки
- `resolveTeamEntry(entry)` - Разрешение ссылок на команды в сетке
- `getResolvedTeamIds(currentMatch)` - Получение ID команд для матча

### Управление матчами

- `startTournamentMatch()` - Начало матча
- `updateCurrentPlayerInfo()` - Обновление информации о текущем игроке
- `startNextPlayer()` - Переход к следующему игроку
- `endPlayerGame()` - Завершение игры игрока
- `isMatchComplete()` - Проверка завершения матча
- `endMatch()` - Завершение матча

### Результаты

- `exportMatchResults()` - Экспорт результатов матча в .txt
- `continueTournament()` - Переход к следующему матчу
- `endTournament()` - Завершение турнира

## Алгоритм турнирной сетки

1. **Первый раунд**: Команды разбиваются на пары
2. **Последующие раунды**: Победители предыдущих матчей встречаются между собой
3. **Финал**: Определяется общий победитель

### Пример сетки для 4 команд:
```
Раунд 1: [1 vs 2], [3 vs 4]
Раунд 2: [Победитель 1-2 vs Победитель 3-4]
```

## Подсчет очков

- Каждое отгаданное слово = 1 очко
- Очки игроков суммируются в счет команды
- Победитель матча определяется по общему счету
- При ничьей победитель выбирается случайно

## Экспорт результатов

Функция `exportMatchResults()` создает текстовый файл с:
- Общим счетом матча
- Детальными результатами каждого игрока
- Списками отгаданных и пропущенных слов

## Интеграция с основной игрой

Турнирная система интегрирована с основной игровой логикой через:
- `gameState` - состояние текущей игры
- `startGame()` - функция начала игры
- `endGame()` - функция завершения игры

## Использование

1. Вызвать `showTournamentSetup()` для настройки турнира
2. Добавить команды через `addTeamFromForm()`
3. Начать турнир через `startTournament()`
4. Система автоматически проведет все матчи

## Зависимости

Турнирная система зависит от следующих функций основной игры:
- `showScreen(screenId)` - переключение экранов
- `showNotification(message)` - показ уведомлений
- `startGame()` - начало игры
- `gameState` - состояние игры
